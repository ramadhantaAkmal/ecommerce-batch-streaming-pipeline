version: 2

models:
  - name: mart_daily_sales_performance
    description: |
      Daily sales & fraud performance mart – adjusted for your real data where order status is only 'FRAUD' or 'GENUINE'.
      This is the single source of truth for daily GMV, fraud rate, AOV, and operational KPIs.

    columns:
      - name: order_date
        description: "Date of the orders"
        tests:
          - unique
          - not_null

      - name: year
        tests: [not_null]
      - name: month
        tests: [not_null]
      - name: quarter
        tests: [not_null]
      - name: day_of_week
      - name: day_of_week_number

      - name: total_orders
        description: "All orders placed (fraud + genuine)"

      - name: genuine_orders
        description: "Orders marked as GENUINE → these are the real sales"

      - name: fraud_orders
        description: "Orders marked as FRAUD"

      - name: gross_revenue
        description: "Sum of amount_numeric for all orders (before fraud filtering)"

      - name: net_revenue
        description: "Revenue that actually counts → only GENUINE orders"